schema: '2.0'
stages:
  download:
    cmd: python src/download.py
    deps:
    - path: params.yaml
      hash: md5
      md5: 42500cf61ffc5fb0c75eb582e4c63b4d
      size: 3597
      isexec: true
    - path: src/download.py
      hash: md5
      md5: b23e5a064bf3646dc42d2a9e28d7e374
      size: 1970
      isexec: true
    params:
      params.yaml:
        download:
          kaggle_dataset: manidevesh/hr-dataset-analysis
          kaggle_file: HR_DataSet.csv
          download_folder: data
          download_file: raw_data.csv
    outs:
    - path: data/raw_data.csv
      hash: md5
      md5: 59d378061790edde7de565c9d02dffc7
      size: 566785
      isexec: true
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/raw_data.csv
      hash: md5
      md5: 59d378061790edde7de565c9d02dffc7
      size: 566785
      isexec: true
    - path: mlflow_experiment_name.yaml
      hash: md5
      md5: 92c8f831bc50fe6f080ccd0360a4ea12
      size: 43
      isexec: true
    - path: params.yaml
      hash: md5
      md5: 42500cf61ffc5fb0c75eb582e4c63b4d
      size: 3597
      isexec: true
    - path: src/preprocess.py
      hash: md5
      md5: 8fa9f795505bd6532e2b10d24c450bd1
      size: 8256
      isexec: true
    params:
      params.yaml:
        preprocess:
          input_folder: data
          input_file: raw_data.csv
          output_reference_data_file_path: data/preprocessed_reference_data.csv
          output_current_data_file_path: data/preprocessed_current_data.csv
          rename_map:
            time_spend_company: time_spend_in_company
            Work_accident: had_work_accidents
            left: left_or_not
            promotion_last_5years: promoted_last_5_years
            Department: department
          keep_duplicates: true
          column_impacting_the_split: satisfaction_level
          current_subset_size: 0.1
          prob_coeff: 1.5
          time_period_column_name: time_period
          onehot_name_dictionary_file_path: data/onehot_name_dictionary.json
    outs:
    - path: data/onehot_name_dictionary.json
      hash: md5
      md5: 8155109279f471fe3577e6cf5839f0ca
      size: 776
      isexec: true
    - path: data/preprocessed_current_data.csv
      hash: md5
      md5: aec9386241ff24f952a54e076025ffca
      size: 149924
      isexec: true
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 008046530f015e915f89f394e02ead91
      size: 1347336
      isexec: true
  train:
    cmd: python src/train.py
    deps:
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 008046530f015e915f89f394e02ead91
      size: 1347336
      isexec: true
    - path: mlflow_experiment_name.yaml
      hash: md5
      md5: 92c8f831bc50fe6f080ccd0360a4ea12
      size: 43
      isexec: true
    - path: params.yaml
      hash: md5
      md5: 42500cf61ffc5fb0c75eb582e4c63b4d
      size: 3597
      isexec: true
    - path: src/train.py
      hash: md5
      md5: 03ad44432ed2d1f85031d0427c0e4175
      size: 5921
      isexec: true
    params:
      params.yaml:
        train:
          file_path: data/preprocessed_reference_data.csv
          prediction_column: left_or_not
          test_X_file_path: data/test_X.csv
          test_y_file_path: data/test_y.csv
          random_state: 42
          cross_validations: 3
          max_depth:
          - 2
          - 3
          - 3
          min_samples_split:
          - 8
          - 9
          - 1
          n_estimators:
          - 40
          - 41
          - 10
          learning_rate:
          - 0.8
          - 1.1
          - 0.2
          model_file_path: models/model.pkl
    outs:
    - path: data/test_X.csv
      hash: md5
      md5: fe1369b5a95bd0b9ce9e6cb11b47bbd5
      size: 264369
      isexec: true
    - path: data/test_y.csv
      hash: md5
      md5: 257670cb126e50d9f9cb68d9eee89123
      size: 5412
      isexec: true
    - path: models/model.pkl
      hash: md5
      md5: 9a75510bb1f46f98d4bd61c490469c24
      size: 32662
      isexec: true
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 008046530f015e915f89f394e02ead91
      size: 1347336
      isexec: true
    - path: data/test_y.csv
      hash: md5
      md5: 257670cb126e50d9f9cb68d9eee89123
      size: 5412
      isexec: true
    - path: mlflow_experiment_name.yaml
      hash: md5
      md5: 92c8f831bc50fe6f080ccd0360a4ea12
      size: 43
      isexec: true
    - path: models/model.pkl
      hash: md5
      md5: 9a75510bb1f46f98d4bd61c490469c24
      size: 32662
      isexec: true
    - path: params.yaml
      hash: md5
      md5: 42500cf61ffc5fb0c75eb582e4c63b4d
      size: 3597
      isexec: true
    - path: src/evaluate.py
      hash: md5
      md5: 61721ed48de37058811b3bbd3d58c3ff
      size: 4973
      isexec: true
    params:
      params.yaml:
        evaluate:
          model_file_path: models/model.pkl
          test_X_file_path: data/test_X.csv
          test_y_file_path: data/test_y.csv
          n_repeats: 10
          random_state: 42
          onehot_name_dictionary_file_path: data/onehot_name_dictionary.json
  set_experiment_name:
    cmd: python src/set_experiment_name.py
    deps:
    - path: src/set_experiment_name.py
      hash: md5
      md5: 48bd7687e3456f18c2afecded6684e12
      size: 1067
      isexec: true
    outs:
    - path: mlflow_experiment_name.yaml
      hash: md5
      md5: 92c8f831bc50fe6f080ccd0360a4ea12
      size: 43
      isexec: true
  evidentlyai:
    cmd: python src/evidentlyai.py
    deps:
    - path: data/preprocessed_current_data.csv
      hash: md5
      md5: d4f653292538b9868b4dac9a941b1990
      size: 149930
      isexec: true
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 634f348f08acd03a5ba3207c1cc154cc
      size: 1347330
      isexec: true
    - path: mlflow_experiment_name.yaml
      hash: md5
      md5: cedf90b3b954206309a6166258797926
      size: 43
      isexec: true
    - path: params.yaml
      hash: md5
      md5: 0b32aeb0948da00e2c9e530f102cd404
      size: 3490
      isexec: true
    - path: src/evidentlyai.py
      hash: md5
      md5: e6020a583c419d8c3c592504511fec36
      size: 5844
      isexec: true
    params:
      params.yaml:
        evidentlyai:
          reference_data_file_path: data/preprocessed_reference_data.csv
          current_data_file_path: data/preprocessed_current_data.csv
          model_file_path: models/model.pkl
          prediction_column: left_or_not
          evidently_htmls_folder_name: evidently_htmls
