schema: '2.0'
stages:
  download:
    cmd: python src/download.py
    deps:
    - path: params.yaml
      hash: md5
      md5: a1d1d11c94459ef06558c8fde2377c31
      size: 4145
      isexec: true
    - path: src/download.py
      hash: md5
      md5: 2ea6a088228ceb304be230e1cc4957d2
      size: 3812
      isexec: true
    params:
      params.yaml:
        download:
          kaggle_dataset: manidevesh/hr-dataset-analysis
          kaggle_file: HR_DataSet.csv
          download_folder: data
          download_file: modified_raw_data.csv
          column_impacting_the_split: satisfaction_level
          current_subset_size: 0.1
          prob_coeff: 1.5
          time_period_column_name: time_period
    outs:
    - path: data/modified_raw_data.csv
      hash: md5
      md5: c7db8f8fa58150a48dd561b3ef292690
      size: 699577
      isexec: true
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: data/modified_raw_data.csv
      hash: md5
      md5: 4ddf5c4a7a0ecbab6fd1a157812cade7
      size: 699189
      isexec: true
    - path: src/preprocess.py
      hash: md5
      md5: f3b231be026706de79303664de6d670d
      size: 9000
      isexec: true
    params:
      params.yaml:
        preprocess:
          input_folder: data
          input_file: modified_raw_data.csv
          output_reference_data_file_path: data/preprocessed_reference_data.csv
          output_current_data_file_path: data/preprocessed_current_data.csv
          rename_map:
            number_project: number_of_projects
            time_spend_company: time_spend_in_company
            Work_accident: had_work_accidents
            left: left_or_not
            promotion_last_5years: promoted_last_5_years
            Department: department
          prediction_column: left_or_not
          keep_duplicates: true
          time_period_column_name: time_period
          flask_dict_file_path: data/flask_dictionary.json
          onehot_name_dictionary_file_path: data/onehot_name_dictionary.json
    outs:
    - path: data/flask_dictionary.json
      hash: md5
      md5: 2de61b4af1b8fa139e25c067303a0f0b
      size: 1138
      isexec: true
    - path: data/onehot_name_dictionary.json
      hash: md5
      md5: b82da1ddc0383342f6c9d8812a2b16ab
      size: 784
      isexec: true
    - path: data/preprocessed_current_data.csv
      hash: md5
      md5: 2052500221b8d0231399e31ab4220f6c
      size: 148648
      isexec: true
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 75821af915dabf8f06ccbbcb2571b0ab
      size: 1338642
      isexec: true
  train:
    cmd: python src/train.py
    deps:
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 75821af915dabf8f06ccbbcb2571b0ab
      size: 1338642
      isexec: true
    - path: src/train.py
      hash: md5
      md5: 03ad44432ed2d1f85031d0427c0e4175
      size: 5921
      isexec: true
    params:
      params.yaml:
        train:
          file_path: data/preprocessed_reference_data.csv
          prediction_column: left_or_not
          test_X_file_path: data/test_X.csv
          test_y_file_path: data/test_y.csv
          random_state: 42
          cross_validations: 3
          max_depth:
          - 1
          - 4
          - 1
          min_samples_split:
          - 4
          - 13
          - 4
          n_estimators:
          - 20
          - 61
          - 10
          learning_rate:
          - 0.8
          - 1.3
          - 0.2
          model_file_path: models/model.pkl
    outs:
    - path: data/test_X.csv
      hash: md5
      md5: 7fe31d11d0f7df26f9a569d4a8ed0fc4
      size: 262696
      isexec: true
    - path: data/test_y.csv
      hash: md5
      md5: 365248a91444d5edc5dc42d2d2bfc412
      size: 5378
      isexec: true
    - path: models/model.pkl
      hash: md5
      md5: e2896894c237a5d145f38e244dd57458
      size: 77255
      isexec: true
  evaluate:
    cmd: python src/evaluate.py
    deps:
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 75821af915dabf8f06ccbbcb2571b0ab
      size: 1338642
      isexec: true
    - path: data/test_y.csv
      hash: md5
      md5: 365248a91444d5edc5dc42d2d2bfc412
      size: 5378
      isexec: true
    - path: models/model.pkl
      hash: md5
      md5: e2896894c237a5d145f38e244dd57458
      size: 77255
      isexec: true
    - path: src/evaluate.py
      hash: md5
      md5: 61721ed48de37058811b3bbd3d58c3ff
      size: 4973
      isexec: true
    params:
      params.yaml:
        evaluate:
          model_file_path: models/model.pkl
          test_X_file_path: data/test_X.csv
          test_y_file_path: data/test_y.csv
          n_repeats: 10
          random_state: 42
          onehot_name_dictionary_file_path: data/onehot_name_dictionary.json
  set_experiment_name:
    cmd: python src/set_experiment_name.py
    deps:
    - path: src/set_experiment_name.py
      hash: md5
      md5: 48bd7687e3456f18c2afecded6684e12
      size: 1067
      isexec: true
    outs:
    - path: mlflow_experiment_name.yaml
      hash: md5
      md5: 4dde73914327a5d24ac85561ff141c55
      size: 43
      isexec: true
  evidentlyai:
    cmd: python src/evidentlyai.py
    deps:
    - path: data/preprocessed_current_data.csv
      hash: md5
      md5: 2052500221b8d0231399e31ab4220f6c
      size: 148648
      isexec: true
    - path: data/preprocessed_reference_data.csv
      hash: md5
      md5: 75821af915dabf8f06ccbbcb2571b0ab
      size: 1338642
      isexec: true
    - path: src/evidentlyai.py
      hash: md5
      md5: f9011fec70bcbe0cdbb7f155d3fb964b
      size: 7581
      isexec: true
    params:
      params.yaml:
        evidentlyai:
          evidentlyai_url: https://app.evidently.cloud
          evidentlyai_project_name: Human Resources
          evidentlyai_project_description: Use AdaBoost to predict who left the company
          reference_data_file_path: data/preprocessed_reference_data.csv
          current_data_file_path: data/preprocessed_current_data.csv
          model_file_path: models/model.pkl
          prediction_column: left_or_not
          evidently_htmls_folder_name: evidently_htmls
          current_accuracy_dict_file: current_accuracy_dict.json
    outs:
    - path: current_accuracy_dict.json
      hash: md5
      md5: 6e7a8932f9eb6ab28c441dc9b3db3438
      size: 126
      isexec: true
    - path: evidently_htmls
      hash: md5
      md5: 430b5eb3b73d41f857990657bd55ad23.dir
      size: 9946123
      nfiles: 4
  hugging_face_push:
    cmd: python src/hugging_face_push.py
    deps:
    - path: current_accuracy_dict.json
      hash: md5
      md5: 6e7a8932f9eb6ab28c441dc9b3db3438
      size: 126
      isexec: true
    - path: models/model.pkl
      hash: md5
      md5: e2896894c237a5d145f38e244dd57458
      size: 77255
      isexec: true
    - path: src/hugging_face_push.py
      hash: md5
      md5: 57240488e464e339be79d0ee4604bd51
      size: 1724
      isexec: true
    params:
      params.yaml:
        hugging_face_push:
          hf_repo_id: skuperst/Predicting_Employee_Turnover_at_Sailsfort_Motors
          model_file_path: models/model.pkl
          current_accuracy_dict_file: current_accuracy_dict.json
          f1_threshold: 0.93
